
Generate a git patch file (remember to end the diff with --) that will describe project changes aimed to accomplish the following:

<continue here>

Here is the project content for context:

File Path: .extension\index.js

let lastCheckedMessageIndex = 0;

function isDiffFormat(code) {
  const diffRegex = /^diff --git a\/.* b\/.*$/m;
  return diffRegex.test(code);
}

function saveToFile(filename, content) {
  const blob = new Blob([content], { type: "text/plain" });
  const url = URL.createObjectURL(blob);

  chrome.storage.sync.get(["savePath"], (result) => {
    const savePath = result.savePath || "";
    const fullPath = savePath + filename;

    chrome.downloads.download({
      url,
      filename: fullPath,
      conflictAction: "uniquify",
      saveAs: false,
    });

    URL.revokeObjectURL(url);
  });
}

function checkNewMessages() {
  console.log("Checking for new messages...");
  const messages = document.querySelectorAll(".markdown");

  for (let i = lastCheckedMessageIndex; i < messages.length; i++) {
    const message = messages[i];
    const codeElement = message.querySelector("pre code");

    if (codeElement) {
      const code = codeElement.textContent;

      if (isDiffFormat(code)) {
        console.log("Diff format code found. Saving to file.");
        const filename = `contrail.patch`;
        saveToFile(filename, code);
      }
    }
  }

  lastCheckedMessageIndex = messages.length;
}

chrome.storage.sync.get(["checkInterval"], (result) => {
  const checkInterval = (result.checkInterval || 5) * 1000;
  // Check for new messages based on the stored interval
  setInterval(checkNewMessages, checkInterval);
});


File Path: .extension\manifest.json

{
  "manifest_version": 2,
  "name": "ChatGPT Code Monitor",
  "version": "1.0.0",
  "description": "Monitor ChatGPT conversation for diff format code and save it to a file.",
  "content_scripts": [
    {
      "matches": ["*://*.openai.com/*"],
      "js": ["index.js"],
      "run_at": "document_end"
    }
  ],
  "permissions": ["downloads", "storage"],
  "options_page": "options.html"
}


File Path: .extension\options.css

body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f5f5f5;
}

.container {
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
    background-color: #fff;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

h1 {
    font-size: 24px;
    margin-bottom: 20px;
}

label {
    display: block;
    font-size: 16px;
    margin-bottom: 5px;
}

input {
    display: block;
    width: 100%;
    font-size: 16px;
    padding: 5px;
    margin-bottom: 20px;
}

button {
    font-size: 16px;
    padding: 5px 10px;
    background-color: #3b98e2;
    color: #fff;
    border: none;
    cursor: pointer;
    transition: background-color 0.2s;
}

button:hover {
    background-color: #2d78b9;
}


File Path: .extension\options.html

<!DOCTYPE html>
<html>
<head>
    <title>ChatGPT Code Monitor Options</title>
    <link rel="stylesheet" href="options.css" />
</head>
<body>
<div class="container">
    <h1>ChatGPT Code Monitor Options</h1>
    <label for="savePath">Save path:</label>
    <input type="text" id="savePath" />
    <label for="checkInterval">Check interval (in seconds):</label>
    <input type="number" id="checkInterval" min="1" />
    <button id="saveButton">Save</button>
</div>
<script src="options.js"></script>
</body>
</html>


File Path: .extension\options.js

document.getElementById("saveButton").addEventListener("click", () => {
  const savePath = document.getElementById("savePath").value;
  const checkInterval = parseInt(
    document.getElementById("checkInterval").value,
    10
  );

  chrome.storage.sync.set({ savePath, checkInterval }, () => {
    console.log(`Save path set to: ${savePath}`);
    console.log(`Check interval set to: ${checkInterval} seconds`);
  });
});


File Path: .extension\README.md

# ChatGPT Code Monitor

ChatGPT Code Monitor is a browser extension that monitors ChatGPT conversations for diff format code and saves it to a file.

## Installation

1. Clone the repository to your local machine.
2. Load the extension into your browser as an unpacked extension:
   - For Chrome:
     - Navigate to `chrome://extensions`.
     - Enable Developer Mode by clicking the toggle switch.
     - Click "Load unpacked" and select the `.extension` folder in the project directory.

## Usage

When a ChatGPT conversation contains diff format code, the extension will automatically save it as a `.patch` file to the specified save path. The extension checks for new messages every 5 seconds.

## Configuration

You can configure the save path for the generated files and the interval for checking new messages through the extension's options page:

1. Open the ChatGPT Code Monitor Options page.
2. Enter the desired save path in the "Save path" input field.
3. Enter the desired check interval in seconds in the "Check interval" input field.
4. Click "Save" to save your changes.

